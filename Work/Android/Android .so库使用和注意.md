# .soåº“ä½¿ç”¨å’Œæ³¨æ„

å¼€å‘Androidåº”ç”¨æ—¶ï¼Œæœ‰æ—¶å€™Javaå±‚çš„ç¼–ç ä¸èƒ½æ»¡è¶³å®žçŽ°éœ€æ±‚ï¼Œå°±éœ€è¦åˆ°C/C++å®žçŽ°åŽç”ŸæˆSOæ–‡ä»¶ï¼Œå†ç”¨`System.loadLibrary()`åŠ è½½è¿›è¡Œè°ƒç”¨ï¼Œè¿™é‡Œæˆä¸ºJNIå±‚çš„å®žçŽ°ã€‚å¸¸è§çš„åœºæ™¯å¦‚ï¼šåŠ è§£å¯†ç®—æ³•ï¼ŒéŸ³è§†é¢‘ç¼–è§£ç ç­‰ã€‚åœ¨ç”ŸæˆSOæ–‡ä»¶æ—¶ï¼Œéœ€è¦è€ƒè™‘é€‚é…å¸‚é¢ä¸Šä¸åŒæ‰‹æœºCPUæž¶æž„ï¼Œè€Œç”Ÿæˆæ”¯æŒä¸åŒå¹³å°çš„SOæ–‡ä»¶è¿›è¡Œå…¼å®¹ã€‚

#### ä¸€ï¼ŒAndroidæ”¯æŒçš„CPUæž¶æž„
å¯¹äºŽCPUæ¥è¯´ï¼Œä¸åŒçš„æž¶æž„å¹¶ä¸æ„å‘³ç€ä¸€å®šäº’ä¸å…¼å®¹ï¼Œæ ¹æ®ç›®å‰Androidå…±æ”¯æŒä¸ƒç§ä¸åŒç±»åž‹çš„CPUæž¶æž„ï¼Œå…¶å…¼å®¹ç‰¹ç‚¹å¯æ€»ç»“å¦‚ä¸‹ï¼š
* armeabiè®¾å¤‡åªå…¼å®¹armeabiï¼›
* armeabi-v7aè®¾å¤‡å…¼å®¹armeabi-v7aã€armeabiï¼ˆé’ˆå¯¹æœ‰æµ®ç‚¹è¿ç®—æˆ–é«˜çº§æ‰©å±•åŠŸèƒ½çš„ï¼‰ï¼›
* arm64-v8aè®¾å¤‡å…¼å®¹arm64-v8aã€armeabi-v7aã€armeabiï¼›
* X86è®¾å¤‡å…¼å®¹X86ã€armeabiï¼›
* X86_64è®¾å¤‡å…¼å®¹X86_64ã€X86ã€armeabiï¼›
* mips64è®¾å¤‡å…¼å®¹mips64ã€mipsï¼›
* mipsåªå…¼å®¹mipsï¼› 

**æ€»ç»“ï¼š**
* armeabiçš„SOæ–‡ä»¶åŸºæœ¬ä¸Šå¯ä»¥è¯´æ˜¯ä¸‡é‡‘æ²¹ï¼Œå®ƒèƒ½è¿è¡Œåœ¨é™¤äº†mipså’Œmips64çš„è®¾å¤‡ä¸Šï¼Œä½†åœ¨éžarmeabiè®¾å¤‡ä¸Šè¿è¡Œæ€§èƒ½è¿˜æ˜¯æœ‰æ‰€æŸè€—ï¼›
* 64ä½çš„CPUæž¶æž„æ€»èƒ½å‘ä¸‹å…¼å®¹å…¶å¯¹åº”çš„32ä½æŒ‡ä»¤é›†ï¼Œå¦‚ï¼šx86_64å…¼å®¹X86ï¼Œarm64-v8aå…¼å®¹armeabi-v7aï¼Œmips64å…¼å®¹mipsï¼›

#### äºŒï¼Œ.soåº“æœ€ä½³é€‰æ‹©
ä»Žç›®å‰æ‰‹æœºç«¯CPUå¸‚åœºçš„ä»½é¢æ•°æ®çœ‹ï¼ŒARMæž¶æž„å‡ ä¹Žåž„æ–­ï¼Œæ‰€ä»¥ï¼Œé™¤éžä½ çš„ç”¨æˆ·å¾ˆç‰¹æ®Šï¼Œå¦åˆ™å‡ ä¹Žå¯ä»¥ä¸è€ƒè™‘å•ç‹¬ç¼–è¯‘å¸¦å…¥X86ã€X86_64ã€mipsã€mips64æž¶æž„SOæ–‡ä»¶ã€‚è€Œåœ¨ARMæž¶æž„ä¸­ï¼Œæ¯”å¦‚é«˜é€šéªé¾™èŠ¯ç‰‡åœ¨2014å¹´å‘å¸ƒçš„410ï¼610ï¼808åŠä»¥åŽçš„èŠ¯ç‰‡éƒ½æ˜¯arm64-v8aæž¶æž„ï¼ŒåŽä¸ºéº’éºŸ6xxç³»åˆ—å’Œ930åŠä»¥åŽä¹Ÿéƒ½æ˜¯arm64-v8aæž¶æž„ï¼Œè”å‘ç§‘ï¼Ÿï¼Ÿ?

![è”å‘ç§‘ï¼šä¸€æ ¸æœ‰éš¾ï¼Œä¹æ ¸å›´è§‚ðŸ˜œðŸ˜ðŸ˜‚](http://upload-images.jianshu.io/upload_images/760576-18dda8e6362a8b8d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

æ‰€ä»¥ï¼š
* å°±ç›®å‰å¸‚åœºä»½é¢è€Œè¨€ï¼Œç»å¤§éƒ¨åˆ†çš„è®¾å¤‡éƒ½å·²ç»æ˜¯arm64-v8aã€armeabi-v7aï¼Œå¯ä»¥åªä¿ç•™armeabi-v7aæž¶æž„çš„SOæ–‡ä»¶ï¼Œè¿™æ ·APKä½“ç§¯ä¼šæ›´å°ï¼ˆç›®å‰ Facebook å’Œ Twitter ä»¥åŠGoogleå®¶åº”ç”¨ç­‰å¤§åŽ‚éƒ½åªç”¨armeabi-v7açš„.soæ–‡ä»¶ï¼‰ã€‚
* å¦‚æžœæƒ³è¦å…¼å®¹æ€§æ›´å¹¿ã€æ€§èƒ½å¥½äº›ï¼ˆæ¯•ç«Ÿå¯¹åº”æž¶æž„è®¾å¤‡ä½¿ç”¨å¯¹åº”.soåº“æ–‡ä»¶æ‰èƒ½å‘æŒ¥æœ€å¤§æ€§èƒ½ï¼‰ï¼Œå¯ä»¥åœ¨ä¸åŒçš„ç›®å½•ä¸‹é¢æ”¾ç½®ä¸åŒçš„.soåº“æ–‡ä»¶ã€‚

#### ä¸‰ï¼Œä½¿ç”¨æ³¨æ„
* **è™½ç„¶arm64-v8aæ˜¯å¯ä»¥å‘ä¸‹å…¼å®¹çš„ï¼Œä½†æ˜¯ä¹Ÿæ˜¯å…¼å®¹çš„æœ‰é™åˆ¶çš„ã€‚**
   * å¯¹äºŽarm64-v8aæž¶æž„çš„æ‰‹æœºï¼Œåœ¨è¿è¡Œappæ—¶ï¼Œè¿›å…¥jnilibsåŽ»è¯»å–åº“æ–‡ä»¶æ—¶ï¼Œå¦‚æžœæœ‰arm64-v8aæ–‡ä»¶å¤¹ï¼Œå°±åŽ»æ‰¾ç›¸å¯¹åº”çš„.soæ–‡ä»¶ï¼Œå¦‚æžœæ²¡æœ‰è¯¥æ–‡ä»¶å¤¹ï¼ŒåŽ»æ‰¾armeabi-v7aæ–‡ä»¶å¤¹ï¼Œå¦‚æžœæ²¡æœ‰ï¼Œå†åŽ»æ‰¾armeabiæ–‡ä»¶å¤¹ï¼Œå¦‚æžœè¿žè¿™ä¸ªæ–‡ä»¶å¤¹ä¹Ÿæ²¡æœ‰ï¼Œå°±æŠ›å‡ºå¼‚å¸¸ï¼›
  * å¦‚æžœæœ‰arm64-v8aæ–‡ä»¶å¤¹ï¼Œé‚£ä¹ˆå°±æ‰¾ç›¸å¯¹åº”çš„.soæ–‡ä»¶ï¼Œæ³¨æ„ï¼š**å¦‚æžœæ²¡æœ‰æ‰¾åˆ°ï¼Œä¸ä¼šå†å¾€ä¸‹ï¼ˆarmeabi-v7aæ–‡ä»¶å¤¹ï¼‰æ‰¾ï¼Œè€Œæ˜¯ç›´æŽ¥æŠ›å‡ºå¼‚å¸¸ã€‚**
* **åº”è¯¥ä¸ºæ¯ä¸ªABIç›®å½•æä¾›å¯¹åº”çš„.soæ–‡ä»¶**
  ä¾‹å¦‚ï¼šç¬¬ä¸‰æ–¹aaræ–‡ä»¶ï¼Œå¦‚æžœè¿™ä¸ªsdkå¯¹abiçš„æ”¯æŒæ¯”è¾ƒå…¨ï¼Œå¯èƒ½ä¼šåŒ…å«armeabiã€armeabi-v7aã€x86ã€arm64-v8aã€x86_64äº”ç§abiï¼Œè€Œä½ åº”ç”¨çš„å…¶å®ƒsoåªæ”¯æŒarmeabiã€armeabi-v7aã€x86ä¸‰ç§ï¼Œç›´æŽ¥å¼•ç”¨sdkçš„aarï¼Œä¼šè‡ªåŠ¨ç¼–è¯‘å‡ºæ”¯æŒ5ç§abiçš„åŒ…ã€‚ä½†æ˜¯åº”ç”¨çš„å…¶å®ƒsoç¼ºå°‘å¯¹å…¶å®ƒä¸¤ç§abiçš„æ”¯æŒï¼Œé‚£ä¹ˆå¦‚æžœåº”ç”¨è¿è¡ŒäºŽarm64-v8aã€x86_64ä¸ºé¦–é€‰abiçš„è®¾å¤‡ä¸Šæ—¶ï¼Œå°±ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚

* **å¦‚æžœç”¨åˆ°äº†ç¬¬ä¸‰æ–¹ä¾èµ–ï¼Œæ¯”å¦‚ä¸Šé¢ä¸€ä¸ªä¾‹å­ï¼Œå¯ä»¥åªä¿ç•™ä¸€ä¸ªABIï¼Œä¸”åº”åœ¨build.gradleä¸­åŠ å…¥ndk.abiFiltersï¼š**
  ```
  defaultConfig {  
    ndk {  
        abiFilters "armeabi-v7a"// æŒ‡å®šndkéœ€è¦å…¼å®¹çš„ABI(è¿™æ ·å…¶ä»–ä¾èµ–åŒ…é‡Œx86,armeabiä¹‹ç±»çš„soä¼šè¢«è¿‡æ»¤æŽ‰) 
    }  
  }  
  ```

>å‚è€ƒ
>[Android SOæ–‡ä»¶çš„å…¼å®¹å’Œé€‚é…](http://blog.coderclock.com/2017/05/07/android/Android-so-files-compatibility-and-adaptation/)
>[ä¸ºä½• Twitter åŒºåˆ«äºŽå¾®ä¿¡ã€æ·˜å®ï¼Œåªä½¿ç”¨äº† armeabi-v7aï¼Ÿ](https://www.diycode.cc/topics/691)
>[å…³äºŽAndroidçš„.soæ–‡ä»¶ä½ æ‰€éœ€è¦çŸ¥é“çš„
>](http://www.jianshu.com/p/cb05698a1968)